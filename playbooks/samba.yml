# =============================================================================
# Samba Playbook - SMB Share Configuration
# =============================================================================
# Usage: ansible-playbook playbooks/samba.yml
#        ansible-playbook playbooks/samba.yml --check --diff
# =============================================================================

- name: Configure Samba server
  hosts: nas_server
  become: true
  gather_facts: true

  tasks:
    - name: Setup Samba server
      ansible.builtin.import_tasks: ../tasks/samba.yml
      when: smb_shares is defined
      tags: [samba, smb]

  handlers:
    - name: Reload Samba
      ansible.builtin.systemd:
        name: smbd
        state: reloaded

    - name: Restart Avahi
      ansible.builtin.systemd:
        name: avahi-daemon
        state: restarted
